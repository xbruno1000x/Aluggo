import{s as i}from"./alert-DLWxqPIg.js";document.addEventListener("DOMContentLoaded",()=>{const a=document.getElementById("password-form"),s=document.getElementById("passwordModal");if(!a||!s)return;async function u(l){var r;return fetch(a.action,{method:"POST",headers:{"X-CSRF-TOKEN":((r=a.querySelector('input[name="_token"]'))==null?void 0:r.value)??"",Accept:"application/json"},body:l})}a.addEventListener("submit",async l=>{var p,m;l.preventDefault();const r=new FormData(a),t=document.getElementById("btn-submit-password"),n=t==null?void 0:t.querySelector(".btn-text"),c=t==null?void 0:t.querySelector(".spinner-border");t&&n&&c&&(t.disabled=!0,n.classList.add("d-none"),c.classList.remove("d-none"));try{const o=await u(r);if(!o.ok){let e=null;try{(o.headers.get("content-type")??"").includes("application/json")&&(e=await o.json())}catch{}const f=e&&e.message||"Erro ao alterar senha";i("error",f);return}let d=null;try{(o.headers.get("content-type")??"").includes("application/json")&&(d=await o.json())}catch(e){console.warn("[password-modal] não foi possível parsear JSON da resposta",e)}try{const e=((p=bootstrap==null?void 0:bootstrap.Modal)==null?void 0:p.getOrCreateInstance)&&bootstrap.Modal.getOrCreateInstance(s)||((m=bootstrap==null?void 0:bootstrap.Modal)==null?void 0:m.getInstance)&&bootstrap.Modal.getInstance(s)||new bootstrap.Modal(s);e==null||e.hide()}catch(e){console.warn("[password-modal] fallback para fechar modal",e)}a.reset(),i("success",(d==null?void 0:d.status)??"Senha alterada com sucesso!",2e3)}catch(o){console.error("[password-modal] submit error",o),i("error","Erro de rede. Tente novamente.")}finally{t&&n&&c&&(t.disabled=!1,n.classList.remove("d-none"),c.classList.add("d-none"))}})});
