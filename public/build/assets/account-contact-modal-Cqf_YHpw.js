document.addEventListener("DOMContentLoaded",()=>{y(),L()});function y(){const t=document.getElementById("email-form");if(!t)return;const e=document.getElementById("email-form-alert"),n=document.getElementById("btn-submit-email");t.addEventListener("submit",async m=>{var l;if(m.preventDefault(),!e||!n)return;const c=n.querySelector(".btn-text"),d=n.querySelector(".spinner-border"),o=()=>{n&&c&&d&&(n.disabled=!1,c.classList.remove("d-none"),d.classList.add("d-none"))};e.classList.add("d-none"),e.classList.remove("alert-success","alert-danger"),e.textContent="";const u=new FormData(t),f=Object.fromEntries(u.entries());try{const a=await fetch(t.action,{method:"PUT",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":((l=document.querySelector('meta[name="csrf-token"]'))==null?void 0:l.content)||""},body:JSON.stringify(f)}),s=await a.json();if(a.ok){e.classList.remove("d-none","alert-danger"),e.classList.add("alert-success"),e.textContent=s.status||"E-mail alterado com sucesso!";const i=document.getElementById("current_email");i&&s.email&&(i.value=s.email),t.reset(),o(),setTimeout(()=>{const r=bootstrap.Modal.getInstance(document.getElementById("emailModal"));r==null||r.hide(),setTimeout(()=>{e.classList.add("d-none")},300)},2e3)}else e.classList.remove("d-none","alert-success"),e.classList.add("alert-danger"),e.textContent=s.message||"Erro ao alterar e-mail.",o()}catch{e.classList.remove("d-none","alert-success"),e.classList.add("alert-danger"),e.textContent="Erro ao processar a solicitação.",o()}})}function L(){const t=document.getElementById("phone-form");if(!t)return;const e=document.getElementById("phone-form-alert"),n=document.getElementById("btn-submit-phone");t.addEventListener("submit",async m=>{var l;if(m.preventDefault(),!e||!n)return;const c=n.querySelector(".btn-text"),d=n.querySelector(".spinner-border"),o=()=>{n&&c&&d&&(n.disabled=!1,c.classList.remove("d-none"),d.classList.add("d-none"))};e.classList.add("d-none"),e.classList.remove("alert-success","alert-danger"),e.textContent="";const u=new FormData(t),f=Object.fromEntries(u.entries());try{const a=await fetch(t.action,{method:"PUT",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":((l=document.querySelector('meta[name="csrf-token"]'))==null?void 0:l.content)||""},body:JSON.stringify(f)}),s=await a.json();if(a.ok){e.classList.remove("d-none","alert-danger"),e.classList.add("alert-success"),e.textContent=s.status||"Telefone alterado com sucesso!";const i=document.getElementById("current_phone");i&&s.telefone&&(i.value=s.telefone),t.reset(),o(),setTimeout(()=>{const r=bootstrap.Modal.getInstance(document.getElementById("phoneModal"));r==null||r.hide(),setTimeout(()=>{e.classList.add("d-none")},300)},2e3)}else e.classList.remove("d-none","alert-success"),e.classList.add("alert-danger"),e.textContent=s.message||"Erro ao alterar telefone.",o()}catch{e.classList.remove("d-none","alert-success"),e.classList.add("alert-danger"),e.textContent="Erro ao processar a solicitação.",o()}})}
