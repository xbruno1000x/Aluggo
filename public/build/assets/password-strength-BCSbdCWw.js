class h{constructor(s){this.confirmPasswordInput=null,this.progressContainer=null,this.progressBar=null,this.messagesContainer=null,this.showProgressBar=!0;const e=document.getElementById(s.passwordInputId);if(!e){console.warn(`Password input with id "${s.passwordInputId}" not found`);return}this.passwordInput=e,this.confirmPasswordInput=s.confirmPasswordInputId?document.getElementById(s.confirmPasswordInputId):null,this.showProgressBar=s.showProgressBar!==!1,this.init()}init(){this.showProgressBar&&this.createProgressBar(),this.createMessagesContainer(),this.attachEventListeners()}createProgressBar(){var e;this.progressContainer=document.createElement("div"),this.progressContainer.className="password-strength-container mt-2",this.progressBar=document.createElement("div"),this.progressBar.className="progress",this.progressBar.style.height="10px";const s=document.createElement("div");s.className="progress-bar",s.id=`${this.passwordInput.id}-strength-bar`,s.setAttribute("role","progressbar"),s.style.width="0%",this.progressBar.appendChild(s),this.progressContainer.appendChild(this.progressBar),(e=this.passwordInput.parentElement)==null||e.insertBefore(this.progressContainer,this.passwordInput.nextSibling)}createMessagesContainer(){var e;this.messagesContainer=document.createElement("div"),this.messagesContainer.className="password-requirements mt-2",this.messagesContainer.id=`${this.passwordInput.id}-requirements`;const s=this.progressContainer||this.passwordInput;(e=s.parentElement)==null||e.insertBefore(this.messagesContainer,s.nextSibling)}attachEventListeners(){this.passwordInput.addEventListener("input",()=>{this.validatePassword()}),this.confirmPasswordInput&&this.confirmPasswordInput.addEventListener("input",()=>{this.validatePasswordMatch()});const s=this.passwordInput.closest("form");s&&s.addEventListener("submit",e=>{this.validatePassword().isValid||(e.preventDefault(),this.showError("Por favor, corrija os requisitos de senha antes de continuar."))})}validatePassword(){const s=this.passwordInput.value,e=this.checkPasswordStrength(s);return this.updateUI(e),e}checkPasswordStrength(s){const e=[];let t=0;const r=s.length>=8,o=/[A-Z]/.test(s),l=/[a-z]/.test(s),d=/[0-9]/.test(s),c=/[!@#$%^&*()_+\-=\[\]{};':"\\|,.<>\/?]/.test(s);r?t+=20:e.push("Mínimo de 8 caracteres"),o?t+=20:e.push("Uma letra maiúscula"),l?t+=20:e.push("Uma letra minúscula"),d?t+=20:e.push("Um número"),c?t+=20:e.push("Um símbolo (!@#$%^&* etc)"),s.length>=12&&(t+=10);let i,a,n;return t<40?(i="weak",a="bg-danger",n=25):t<70?(i="fair",a="bg-warning",n=50):t<100?(i="good",a="bg-info",n=75):(i="strong",a="bg-success",n=100),{score:t,strength:i,color:a,percentage:n,messages:e,isValid:r&&o&&l&&d&&c}}updateUI(s){if(this.progressBar){const e=this.progressBar.querySelector(".progress-bar");if(e){e.style.width=`${s.percentage}%`,e.className=`progress-bar ${s.color}`;const t={weak:"Fraca",fair:"Razoável",good:"Boa",strong:"Forte"};e.setAttribute("aria-valuenow",s.percentage.toString()),e.textContent=this.passwordInput.value?t[s.strength]:""}}this.messagesContainer&&(s.messages.length>0&&this.passwordInput.value?this.messagesContainer.innerHTML=`
                    <small class="text-muted">
                        <strong>Requisitos faltantes:</strong>
                        <ul class="mb-0 ps-3">
                            ${s.messages.map(e=>`<li>${e}</li>`).join("")}
                        </ul>
                    </small>
                `:this.passwordInput.value?this.messagesContainer.innerHTML=`
                    <small class="text-success">
                        <i class="bi bi-check-circle-fill"></i> Senha forte! Todos os requisitos atendidos.
                    </small>
                `:this.messagesContainer.innerHTML=""),this.passwordInput.value?s.isValid?(this.passwordInput.classList.remove("is-invalid"),this.passwordInput.classList.add("is-valid")):(this.passwordInput.classList.remove("is-valid"),this.passwordInput.classList.add("is-invalid")):this.passwordInput.classList.remove("is-valid","is-invalid")}validatePasswordMatch(){var t;if(!this.confirmPasswordInput)return;const s=this.passwordInput.value,e=this.confirmPasswordInput.value;if(e&&s!==e){this.confirmPasswordInput.classList.add("is-invalid"),this.confirmPasswordInput.classList.remove("is-valid");let r=this.confirmPasswordInput.nextElementSibling;(!r||!r.classList.contains("invalid-feedback"))&&(r=document.createElement("div"),r.className="invalid-feedback",(t=this.confirmPasswordInput.parentElement)==null||t.insertBefore(r,this.confirmPasswordInput.nextSibling)),r.textContent="As senhas não coincidem"}else if(e){this.confirmPasswordInput.classList.remove("is-invalid"),this.confirmPasswordInput.classList.add("is-valid");const r=this.confirmPasswordInput.nextElementSibling;r&&r.classList.contains("invalid-feedback")&&(r.textContent="")}else this.confirmPasswordInput.classList.remove("is-valid","is-invalid")}showError(s){const e=document.createElement("div");e.className="alert alert-danger alert-dismissible fade show",e.setAttribute("role","alert"),e.innerHTML=`
            ${s}
            <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
        `;const t=this.passwordInput.closest("form");t&&(t.insertBefore(e,t.firstChild),setTimeout(()=>{e.remove()},5e3))}}document.addEventListener("DOMContentLoaded",()=>{document.getElementById("password")&&new h({passwordInputId:"password",confirmPasswordInputId:"password_confirmation",showProgressBar:!0})});
